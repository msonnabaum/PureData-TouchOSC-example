#N canvas 344 94 653 667 10;
#X obj 228 22 inlet;
#X obj 376 231 unpack 0 0 0;
#X obj 102 622 expr sqrt(pow($f1 \, 2) + pow($f2 \, 2) + pow($f3 \,
2));
#X obj 367 290 atan;
#X obj 367 269 expr $f1 / $f2;
#X obj 399 314 expr if ($f1 > 0 \, 3.14159 \, -3.14159);
#X obj 367 341 pack 0 0 0;
#X obj 367 363 expr if ($f3 <= 0 \, $f1 + $f2 \, $f1);
#X obj 367 385 * -1;
#X obj 338 71 unpack 0 0 0;
#X text 85 524 The pitch and roll are only accurate if there are no
extra accelerations due to hand movement. We can check if the total
acceleration is close to gravity and only use pitch and roll in that
case. The total acceleration is given by:;
#X text 350 49 raw accerlation:;
#X obj 41 231 unpack 0 0 0;
#X obj 52 290 atan;
#X obj 52 269 expr $f1 / $f2;
#X obj 84 314 expr if ($f1 > 0 \, 3.14159 \, -3.14159);
#X obj 52 341 pack 0 0 0;
#X obj 52 363 expr if ($f3 <= 0 \, $f1 + $f2 \, $f1);
#X obj 52 385 * -1;
#X obj 235 588 unpack 0 0 0;
#X obj 51 453 s \$0-iPhone-pitch-set;
#X obj 367 454 s \$0-iPhone-roll-set;
#X obj 337 128 s \$0-iPhone-accX-set;
#X obj 377 110 s \$0-iPhone-accY-set;
#X obj 417 91 s \$0-iPhone-accZ-set;
#X connect 0 0 9 0;
#X connect 0 0 12 0;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 1 0 5 0;
#X connect 1 2 4 1;
#X connect 1 2 6 2;
#X connect 3 0 6 0;
#X connect 4 0 3 0;
#X connect 5 0 6 1;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 8 0 21 0;
#X connect 9 0 22 0;
#X connect 9 1 23 0;
#X connect 9 2 24 0;
#X connect 12 1 14 0;
#X connect 12 1 15 0;
#X connect 12 2 14 1;
#X connect 12 2 16 2;
#X connect 13 0 16 0;
#X connect 14 0 13 0;
#X connect 15 0 16 1;
#X connect 16 0 17 0;
#X connect 17 0 18 0;
#X connect 18 0 20 0;
#X connect 19 0 2 0;
#X connect 19 1 2 1;
#X connect 19 2 2 2;
